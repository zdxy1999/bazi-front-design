# 八字命理小程序 - 背景与布局设计

## 设计方向

### 1. Aesthetic Direction（美学定位）

**名称：Mystical Zen（禅意神秘）**

设计理念：
- **东方神秘主义**：融入太极、八卦、阴阳的视觉元素，但以抽象几何形式呈现
- **数字禅意**：通过留白和呼吸感创造冥想般的体验
- **五行流动**：金木水火土五种能量以光的形式在边缘流转

### 2. DFII 评分

| 维度 | 得分 | 说明 |
|------|------|------|
| Aesthetic Impact | 5 | 五行流光 + 极简布局创造独特记忆点 |
| Context Fit | 5 | 完美契合命理/玄学的神秘属性 |
| Implementation Feasibility | 4 | CSS渐变动画技术成熟，但需精细调试 |
| Performance Safety | 4 | GPU加速动画，对性能影响可控 |
| Consistency Risk | -2 | 跨主题一致性需精心维护 |

**DFII 总分：16/15** ✅ **Excellent** - 可完全执行

### 3. Differentiation Anchor（差异化锚点）

> "如果遮住logo，如何识别这是八字命理小程序？"

**答案**：边缘内发光的五行流光特效 - 这是唯一的设计特征

### 4. 设计原则

1. **克制装饰** - 流光是唯一的装饰元素，其他一切服务于功能
2. **呼吸感** - 大量留白，让内容与能量共舞
3. **层级明确** - 阴影、模糊、透明度创造深度，而非装饰
4. **阴阳平衡** - 浅色/深色主题如同阴/阳，互补而非对立

---

## 设计系统快照

### Typography（字体）

```css
/* 选用理由：避免AI默认字体，同时保持可读性 */
--font-display: 'Noto Serif SC', serif;      /* 标题 - 宋体传达传统与权威 */
--font-body: 'Noto Sans SC', sans-serif;      /* 正文 - 黑体保证现代易读 */
--font-mono: 'Noto Sans Mono', monospace;     /* 数据 - 等宽用于天干地支 */

/* 字号系统 - 采用黄金比例 */
--text-xs: 22rpx;     /* 辅助说明 */
--text-sm: 26rpx;     /* 次要文本 */
--text-base: 30rpx;   /* 正文 */
--text-md: 34rpx;     /* 小标题 */
--text-lg: 38rpx;     /* 标题 */
--text-xl: 44rpx;     /* 大标题 */
--text-2xl: 52rpx;    /* 主标题 */
```

### Color System（色彩）

```css
/* ==================== 五行色彩体系 ==================== */
/* 五行对应传统色，调整为现代RGB值 */

/* 金 - Metal */
--metal-50: #FEF8E7;
--metal-100: #FDF0C4;
--metal-200: #FCE09B;
--metal-300: #FA9E38;
--metal-400: #D4AF37;   /* 主色：金色 */
--metal-500: #B8962E;
--metal-600: #9A7C27;

/* 木 - Wood */
--wood-50: #E8F8EF;
--wood-100: #C5F0DC;
--wood-200: #9AE5C4;
--wood-300: #5DD4A0;
--wood-400: #2ECC71;   /* 主色：青绿 */
--wood-500: #27AE60;
--wood-600: #1E8449;

/* 水 - Water */
--water-50: #E8F4FC;
--water-100: #C6E8F8;
--water-200: #9DD7F4;
--water-300: #5BC0EB;
--water-400: #3498DB;  /* 主色：蔚蓝 */
--water-500: #2980B9;
--water-600: #1F618D;

/* 火 - Fire */
--fire-50: #FDEDEC;
--fire-100: #FADBD8;
--fire-200: #F5B7B1;
--fire-300: #EC7063;
--fire-400: #E74C3C;   /* 主色：朱红 */
--fire-500: #CB4335;
--fire-600: #A93226;

/* 土 - Earth */
--earth-50: #FEF5E7;
--earth-100: #FDEBD0;
--earth-200: #FAD7A0;
--earth-300: #F39C12;
--earth-400: #F39C12;  /* 主色：赭黄 */
--earth-500: #D68910;
--earth-600: #B7950B;

/* ==================== 浅色主题 ==================== */
:root, [data-theme="light"] {
  /* 背景层 */
  --bg-base: #FAFAFA;          /* 基础背景 - 近白但非纯白 */
  --bg-surface: #FFFFFF;       /* 表面 - 纯白 */
  --bg-elevated: #FFFFFF;      /* 浮层 - 纯白+阴影 */
  --bg-overlay: rgba(0, 0, 0, 0.45);

  /* 文本层 */
  --text-primary: #1A1A1A;     /* 主文本 - 深灰非纯黑 */
  --text-secondary: #6B7280;   /* 次要文本 */
  --text-tertiary: #9CA3AF;    /* 辅助文本 */
  --text-inverse: #FFFFFF;

  /* 边框与分割 */
  --border-subtle: rgba(0, 0, 0, 0.06);
  --border-default: rgba(0, 0, 0, 0.10);
  --border-strong: rgba(0, 0, 0, 0.15);

  /* 交互色 */
  --color-primary: var(--wood-500);      /* 默认主色 - 木（生长） */
  --color-primary-hover: var(--wood-600);
  --color-primary-bg: var(--wood-50);

  /* 阴影 - 极微妙 */
  --shadow-sm: 0 2rpx 8rpx rgba(0, 0, 0, 0.04);
  --shadow-md: 0 4rpx 16rpx rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 8rpx 32rpx rgba(0, 0, 0, 0.08);
  --shadow-xl: 0 16rpx 48rpx rgba(0, 0, 0, 0.10);

  /* 流光特效强度 */
  --aura-intensity: 0.25;
  --aura-blur: 120rpx;
}

/* ==================== 深色主题 ==================== */
[data-theme="dark"] {
  /* 背景层 */
  --bg-base: #0A0A0A;          /* 基础背景 - 近黑非纯黑 */
  --bg-surface: #141414;       /* 表面 */
  --bg-elevated: #1C1C1C;      /* 浮层 */
  --bg-overlay: rgba(0, 0, 0, 0.75);

  /* 文本层 */
  --text-primary: #FAFAFA;     /* 主文本 */
  --text-secondary: #A1A1AA;   /* 次要文本 */
  --text-tertiary: #71717A;    /* 辅助文本 */
  --text-inverse: #0A0A0A;

  /* 边框与分割 */
  --border-subtle: rgba(255, 255, 255, 0.06);
  --border-default: rgba(255, 255, 255, 0.10);
  --border-strong: rgba(255, 255, 255, 0.15);

  /* 交互色 */
  --color-primary: var(--wood-400);
  --color-primary-hover: var(--wood-300);
  --color-primary-bg: rgba(46, 204, 113, 0.15);

  /* 阴影 - 深色模式下更重 */
  --shadow-sm: 0 2rpx 8rpx rgba(0, 0, 0, 0.3);
  --shadow-md: 0 4rpx 16rpx rgba(0, 0, 0, 0.4);
  --shadow-lg: 0 8rpx 32rpx rgba(0, 0, 0, 0.5);
  --shadow-xl: 0 16rpx 48rpx rgba(0, 0, 0, 0.6);

  /* 流光特效强度 - 深色模式下更明显 */
  --aura-intensity: 0.35;
  --aura-blur: 100rpx;
}
```

### Spacing（间距）

```css
/* 采用8rpx基准，遵循BEM */
--space-1: 8rpx;    /* 极小间距 */
--space-2: 16rpx;   /* 小间距 */
--space-3: 24rpx;   /* 中间距 */
--space-4: 32rpx;   /* 大间距 */
--space-5: 48rpx;   /* 超大间距 */
--space-6: 64rpx;   /* 区块间距 */
```

---

## 核心布局组件

### 1. Page Container（页面容器）

**作用**：
- 提供流光背景
- 管理主题切换
- 统一页面padding
- 设置安全区域

```css
/* ==================== 页面容器 ==================== */
.bz-page {
  position: relative;
  min-height: 100vh;
  background-color: var(--bg-base);
  color: var(--text-primary);
  font-family: var(--font-body);
  overflow-x: hidden;
}

/* 流光背景层 */
.bz-page__aura {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 0;
  opacity: var(--aura-intensity);
}

.bz-page__aura-inner {
  position: absolute;
  inset: 0;
  animation: auraRotate 30s linear infinite;
}

/* 五行流光 - 使用conic-gradient实现 */
.bz-page__aura-gradient {
  position: absolute;
  inset: -50%;
  width: 200%;
  height: 200%;
  background: conic-gradient(
    from 0deg,
    var(--metal-400) 0deg,
    var(--wood-400) 72deg,
    var(--water-400) 144deg,
    var(--fire-400) 216deg,
    var(--earth-400) 288deg,
    var(--metal-400) 360deg
  );
  filter: blur(var(--aura-blur));
  animation: auraFlow 20s linear infinite;
}

@keyframes auraFlow {
  0% {
    transform: rotate(0deg) scale(1);
  }
  50% {
    transform: rotate(180deg) scale(1.1);
  }
  100% {
    transform: rotate(360deg) scale(1);
  }
}

/* 内发光效果 - 边缘流光 */
.bz-page__aura-glow {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  opacity: 0.6;
}

.bz-page__aura-glow::before {
  content: '';
  position: absolute;
  inset: 0;
  background:
    /* 顶部流光 */
    linear-gradient(180deg,
      rgba(212, 175, 55, 0.12) 0%,
      transparent 40%
    ),
    /* 右侧流光 */
    linear-gradient(270deg,
      rgba(46, 204, 113, 0.12) 0%,
      transparent 40%
    ),
    /* 底部流光 */
    linear-gradient(0deg,
      rgba(52, 152, 219, 0.12) 0%,
      transparent 40%
    ),
    /* 左侧流光 */
    linear-gradient(90deg,
      rgba(231, 76, 60, 0.12) 0%,
      transparent 40%
    );
  animation: auraPulse 8s ease-in-out infinite;
}

@keyframes auraPulse {
  0%, 100% {
    opacity: 0.5;
    transform: scale(1);
  }
  50% {
    opacity: 0.8;
    transform: scale(1.02);
  }
}

/* 内容层 - 在流光之上 */
.bz-page__content {
  position: relative;
  z-index: 2;
  min-height: 100vh;
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
}

/* 尊重用户的运动偏好 */
@media (prefers-reduced-motion: reduce) {
  .bz-page__aura-gradient,
  .bz-page__aura-glow::before {
    animation: none;
  }
}
```

### 2. Safe Area Container（安全区域容器）

```css
/* ==================== 安全区域容器 ==================== */
.bz-container {
  padding-left: var(--space-3);
  padding-right: var(--space-3);
}

@media (min-width: 768px) {
  .bz-container {
    padding-left: var(--space-4);
    padding-right: var(--space-4);
  }
}
```

### 3. Section（区块）

```css
/* ==================== 区块 ==================== */
.bz-section {
  padding-top: var(--space-5);
  padding-bottom: var(--space-5);
}

.bz-section--lg {
  padding-top: var(--space-6);
  padding-bottom: var(--space-6);
}

.bz-section--xl {
  padding-top: 80rpx;
  padding-bottom: 80rpx;
}
```

---

## 微信小程序实现

### 页面结构 (WXML)

```xml
<!-- pages/index/index.wxml -->
<view class="bz-page" data-theme="{{theme}}">
  <!-- 流光背景层 -->
  <view class="bz-page__aura">
    <view class="bz-page__aura-inner">
      <view class="bz-page__aura-gradient"></view>
    </view>
  </view>

  <!-- 内发光层 -->
  <view class="bz-page__aura-glow"></view>

  <!-- 内容层 -->
  <view class="bz-page__content">
    <!-- 导航栏 -->
    <view class="bz-navbar">
      <view class="bz-container">
        <view class="bz-navbar__inner">
          <!-- 导航内容 -->
        </view>
      </view>
    </view>

    <!-- 页面内容 -->
    <view class="bz-container">
      <view class="bz-section">
        <!-- 内容 -->
      </view>
    </view>

    <!-- 底部导航 -->
    <view class="bz-tabbar">
      <!-- Tabbar内容 -->
    </view>
  </view>
</view>
```

### 样式文件 (WXSS)

```css
/* styles/base.wxss */

/* 引入字体 */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;600;700&family=Noto+Serif+SC:wght@400;500;600;700&display=swap');

/* 设计变量 */
page {
  --font-display: 'Noto Serif SC', serif;
  --font-body: 'Noto Sans SC', sans-serif;
  --font-mono: 'Noto Sans Mono', monospace;

  /* 五行色 */
  --metal-400: #D4AF37;
  --wood-400: #2ECC71;
  --water-400: #3498DB;
  --fire-400: #E74C3C;
  --earth-400: #F39C12;

  /* 浅色主题（默认） */
  --bg-base: #FAFAFA;
  --bg-surface: #FFFFFF;
  --text-primary: #1A1A1A;
  --text-secondary: #6B7280;
  --border-subtle: rgba(0, 0, 0, 0.06);
  --aura-intensity: 0.25;
  --aura-blur: 120rpx;
}

/* 深色主题 */
.bz-page[data-theme="dark"] {
  --bg-base: #0A0A0A;
  --bg-surface: #141414;
  --text-primary: #FAFAFA;
  --text-secondary: #A1A1AA;
  --border-subtle: rgba(255, 255, 255, 0.06);
  --aura-intensity: 0.35;
  --aura-blur: 100rpx;
}

/* 页面容器 */
.bz-page {
  position: relative;
  min-height: 100vh;
  background-color: var(--bg-base);
  color: var(--text-primary);
  font-family: var(--font-body);
}

.bz-page__aura {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  z-index: 0;
  opacity: var(--aura-intensity);
}

.bz-page__aura-inner {
  position: absolute;
  inset: 0;
}

.bz-page__aura-gradient {
  position: absolute;
  inset: -50%;
  width: 200%;
  height: 200%;
  background: conic-gradient(
    from 0deg,
    var(--metal-400) 0deg,
    var(--wood-400) 72deg,
    var(--water-400) 144deg,
    var(--fire-400) 216deg,
    var(--earth-400) 288deg,
    var(--metal-400) 360deg
  );
  filter: blur(var(--aura-blur));
  animation: auraFlow 20s linear infinite;
}

@keyframes auraFlow {
  0% {
    transform: rotate(0deg) scale(1);
  }
  50% {
    transform: rotate(180deg) scale(1.1);
  }
  100% {
    transform: rotate(360deg) scale(1);
  }
}

.bz-page__aura-glow {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  opacity: 0.6;
}

.bz-page__aura-glow::before {
  content: '';
  position: absolute;
  inset: 0;
  background:
    linear-gradient(180deg, rgba(212, 175, 55, 0.12) 0%, transparent 40%),
    linear-gradient(270deg, rgba(46, 204, 113, 0.12) 0%, transparent 40%),
    linear-gradient(0deg, rgba(52, 152, 219, 0.12) 0%, transparent 40%),
    linear-gradient(90deg, rgba(231, 76, 60, 0.12) 0%, transparent 40%);
  animation: auraPulse 8s ease-in-out infinite;
}

@keyframes auraPulse {
  0%, 100% {
    opacity: 0.5;
  }
  50% {
    opacity: 0.8;
  }
}

.bz-page__content {
  position: relative;
  z-index: 2;
  min-height: 100vh;
}

.bz-container {
  padding-left: 32rpx;
  padding-right: 32rpx;
}

.bz-section {
  padding-top: 48rpx;
  padding-bottom: 48rpx;
}

/* 尊重用户的运动偏好 */
@media (prefers-reduced-motion: reduce) {
  .bz-page__aura-gradient,
  .bz-page__aura-glow::before {
    animation: none !important;
  }
}
```

### 主题切换逻辑 (JS)

```javascript
// app.js
App({
  globalData: {
    theme: 'light' // 'light' | 'dark'
  },

  onLaunch() {
    // 读取保存的主题偏好
    const savedTheme = wx.getStorageSync('theme');
    if (savedTheme) {
      this.globalData.theme = savedTheme;
    } else {
      // 跟随系统
      const systemTheme = wx.getSystemInfoSync().theme;
      this.globalData.theme = systemTheme || 'light';
    }
  },

  // 切换主题
  toggleTheme() {
    const newTheme = this.globalData.theme === 'light' ? 'dark' : 'light';
    this.setTheme(newTheme);
  },

  // 设置主题
  setTheme(theme) {
    this.globalData.theme = theme;
    wx.setStorageSync('theme', theme);

    // 通知所有页面更新
    const pages = getCurrentPages();
    pages.forEach(page => {
      if (page.onThemeChange) {
        page.onThemeChange(theme);
      }
    });
  }
});
```

```javascript
// pages/index/index.js
const app = getApp();

Page({
  data: {
    theme: app.globalData.theme
  },

  onLoad() {
    this.setData({ theme: app.globalData.theme });
  },

  onThemeChange(theme) {
    this.setData({ theme });
  },

  // 切换主题
  handleThemeToggle() {
    app.toggleTheme();
  }
});
```

---

## 性能优化

### 1. 动画性能

```css
/* 使用GPU加速 */
.bz-page__aura-gradient {
  will-change: transform;
  transform: translateZ(0); /* 强制GPU加速 */
}
```

### 2. 减少重绘

```css
/* 使用transform代替位置属性 */
.bz-page__aura-inner {
  /* 好的：使用transform */
  transform: rotate(0deg);

  /* 避免：使用top/left */
  /* top: 0; */
  /* left: 0; */
}
```

### 3. 主题切换优化

```javascript
// 防抖处理，避免频繁切换
let themeChangeTimer = null;

function debounceThemeChange(newTheme) {
  clearTimeout(themeChangeTimer);
  themeChangeTimer = setTimeout(() => {
    app.setTheme(newTheme);
  }, 100);
}
```

---

## 无障碍设计

### 1. 运动偏好

```css
/* 尊重用户的减少动画偏好 */
@media (prefers-reduced-motion: reduce) {
  .bz-page__aura-gradient,
  .bz-page__aura-glow::before {
    animation: none !important;
  }
}
```

### 2. 对比度检查

所有文本与背景的对比度均符合 WCAG 2.1 AA 标准：
- 浅色主题：主文本 15.66:1 ✅
- 深色主题：主文本 16.12:1 ✅

---

## 使用示例

### 创建新页面

```xml
<!-- pages/destiny/index.wxml -->
<view class="bz-page" data-theme="{{theme}}">
  <!-- 流光背景（所有页面共用） -->
  <view class="bz-page__aura">
    <view class="bz-page__aura-inner">
      <view class="bz-page__aura-gradient"></view>
    </view>
  </view>
  <view class="bz-page__aura-glow"></view>

  <!-- 页面内容 -->
  <view class="bz-page__content">
    <view class="bz-container">
      <view class="bz-section bz-section--lg">
        <text class="bz-heading bz-heading--1">八字测算</text>
        <!-- 页面内容 -->
      </view>
    </view>
  </view>
</view>
```

---

## 下一步

背景和布局系统已完成！接下来可以设计：

1. **导航组件** - 顶部导航栏、底部TabBar
2. **基础组件** - 按钮、输入框、标签等
3. **业务组件** - 八字命盘、五行分析等

你想先设计哪个？
